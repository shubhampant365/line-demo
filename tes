<template>
    <lightning-card title="Asset Onboarding" style="padding: 20px;">
        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Product Name"
                value={productName}
                onchange={handleInputChange}
                data-id="productName"
                disabled={isProductNameDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="productName">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Product Category"
                value={productCategory}
                onchange={handleInputChange}
                data-id="productCategory"
                disabled={isProductCategoryDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="productCategory">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Product Subcategory"
                value={productSubCategory}
                onchange={handleInputChange}
                data-id="productSubCategory"
                disabled={isProductSubCategoryDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="productSubCategory">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Product Code"
                value={productCode}
                onchange={handleInputChange}
                data-id="productCode"
                disabled={isProductCodeDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="productCode">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Date of Purchase"
                type="date"
                value={dateOfPurchase}
                onchange={handleInputChange}
                data-id="dateOfPurchase"
                disabled={isDateOfPurchaseDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="dateOfPurchase">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Date of Installation"
                type="date"
                value={dateOfInstallation}
                onchange={handleInputChange}
                data-id="dateOfInstallation"
                disabled={isDateOfInstallationDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="dateOfInstallation">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Sales Product Code"
                value={salesProductCode}
                onchange={handleInputChange}
                data-id="salesProductCode"
                disabled={isSalesProductCodeDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="salesProductCode">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Invoice Number"
                value={invoiceNumber}
                onchange={handleInputChange}
                data-id="invoiceNumber"
                disabled={isInvoiceNumberDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="invoiceNumber">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Warranty Start Date"
                type="date"
                value={warrantyStartDate}
                onchange={handleInputChange}
                data-id="warrantyStartDate"
                disabled={isWarrantyStartDateDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="warrantyStartDate">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Warranty End Date"
                type="date"
                value={warrantyEndDate}
                onchange={handleInputChange}
                data-id="warrantyEndDate"
                disabled={isWarrantyEndDateDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="warrantyEndDate">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                label="Source of Purchase"
                value={sourceOfPurchase}
                onchange={handleInputChange}
                data-id="sourceOfPurchase"
                disabled={isSourceOfPurchaseDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="sourceOfPurchase">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-textarea
                class="slds-col slds-size_3-of-4"
                label="Remarks"
                value={remarks}
                onchange={handleInputChange}
                data-id="remarks"
                disabled={isRemarksDisabled}>
            </lightning-textarea>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="remarks">
            </lightning-button-icon>
        </div>

        <div class="slds-grid slds-gutters slds-m-bottom_medium">
            <lightning-input
                class="slds-col slds-size_3-of-4"
                type="checkbox"
                label="Rental Asset"
                checked={rentalAsset}
                onchange={handleCheckboxChange}
                data-id="rentalAsset"
                disabled={isRentalAssetDisabled}>
            </lightning-input>
            <lightning-button-icon
                class="slds-col slds-size_1-of-4"
                icon-name="utility:edit"
                alternative-text="Edit"
                onclick={handleEditClick}
                data-id="rentalAsset">
            </lightning-button-icon>
        </div>

        <lightning-button label="Submit" onclick={handleSubmit} class="slds-m-top_medium"></lightning-button>
    </lightning-card>
</template>



import { LightningElement, track, api } from 'lwc';
import { ShowToastEvent } from 'lightning/platformShowToastEvent';
import submitAssetDetails from '@salesforce/apex/AssetOnboardingController.submitAssetDetails';

export default class AssetOnboardNoScan extends LightningElement {
    @api recordId;

    @track productName = '';
    @track productCategory = '';
    @track productSubCategory = '';
    @track productCode = '';
    @track dateOfPurchase = '';
    @track dateOfInstallation = '';
    @track salesProductCode = '';
    @track invoiceNumber = '';
    @track warrantyStartDate = '';
    @track warrantyEndDate = '';
    @track sourceOfPurchase = '';
    @track remarks = '';
    @track rentalAsset = false;

    @track isProductNameDisabled = true;
    @track isProductCategoryDisabled = true;
    @track isProductSubCategoryDisabled = true;
    @track isProductCodeDisabled = true;
    @track isDateOfPurchaseDisabled = true;
    @track isDateOfInstallationDisabled = true;
    @track isSalesProductCodeDisabled = true;
    @track isInvoiceNumberDisabled = true;
    @track isWarrantyStartDateDisabled = true;
    @track isWarrantyEndDateDisabled = true;
    @track isSourceOfPurchaseDisabled = true;
    @track isRemarksDisabled = true;
    @track isRentalAssetDisabled = true;

    handleInputChange(event) {
        const field = event.target.dataset.id;
        this[field] = event.target.type === 'checkbox' ? event.target.checked : event.target.value;
    }

    handleCheckboxChange(event) {
        this.rentalAsset = event.target.checked;
    }

    handleEditClick(event) {
        const field = `is${event.target.dataset.id.charAt(0).toUpperCase() + event.target.dataset.id.slice(1)}Disabled`;
        this[field] = false;
    }

    handleSubmit() {
        const assetDetails = {
            productName: this.productName,
            productCategory: this.productCategory,
            productSubCategory: this.productSubCategory,
            productCode: this.productCode,
            dateOfPurchase: this.dateOfPurchase,
            dateOfInstallation: this.dateOfInstallation,
            salesProductCode: this.salesProductCode,
            invoiceNumber: this.invoiceNumber,
            warrantyStartDate: this.warrantyStartDate,
            warrantyEndDate: this.warrantyEndDate,
            sourceOfPurchase: this.sourceOfPurchase,
            remarks: this.remarks,
            rentalAsset: this.rentalAsset,
            recordId: this.recordId
        };

        submitAssetDetails({ assetDetails })
            .then(() => {
                this.showToast('Success', 'Asset details submitted successfully', 'success');
            })
            .catch(error => {
                this.showToast('Error', error.body.message, 'error');
            });
    }

    showToast(title, message, variant) {
        const event = new ShowToastEvent({
            title: title,
            message: message,
            variant: variant
        });
        this.dispatchEvent(event);
    }
}
